{
  "id": "http://validationtest.org/fhir/StructureDefinition/PatternSliceTestcase",
  ".metadata": {
    "schema-subtype": "resource",
    "sd-info": {
      "url": "http://validationtest.org/fhir/StructureDefinition/PatternSliceTestcase",
      "base": "http://hl7.org/fhir/StructureDefinition/Patient,http://hl7.org/fhir/StructureDefinition/DomainResource,http://hl7.org/fhir/StructureDefinition/Resource",
      "datatype": "Patient",
      "abstract": false,
      "derivation": "constraint"
    }
  },
  "fhir-type-label": "Patient",
  "fhirPath-dom-2": {
    "key": "dom-2",
    "expression": "contained.contained.empty()",
    "severity": "error",
    "bestPractice": false,
    "humanDescription": "If the resource is contained in another resource, it SHALL NOT contain nested Resources"
  },
  "fhirPath-dom-1": {
    "key": "dom-1",
    "expression": "contained.text.empty()",
    "severity": "error",
    "bestPractice": false,
    "humanDescription": "If the resource is contained in another resource, it SHALL NOT contain any narrative"
  },
  "fhirPath-dom-4": {
    "key": "dom-4",
    "expression": "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
    "severity": "error",
    "bestPractice": false,
    "humanDescription": "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated"
  },
  "fhirPath-dom-3": {
    "key": "dom-3",
    "expression": "contained.where(('#'+id in %resource.descendants().reference).not()).empty()",
    "severity": "error",
    "bestPractice": false,
    "humanDescription": "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource"
  },
  "children": {
    "id": {
      "id": "#Patient.id",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/id",
      "xml-order": 10
    },
    "meta": {
      "id": "#Patient.meta",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/Meta",
      "xml-order": 20
    },
    "implicitRules": {
      "id": "#Patient.implicitRules",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/uri",
      "xml-order": 30
    },
    "language": {
      "id": "#Patient.language",
      "binding": {
        "abstractAllowed": true,
        "strength": "extensible",
        "valueSet": "http://hl7.org/fhir/ValueSet/languages"
      },
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/code",
      "xml-order": 40
    },
    "text": {
      "id": "#Patient.text",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/Narrative",
      "xml-order": 50
    },
    "contained": {
      "id": "#Patient.contained",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Resource",
      "xml-order": 60
    },
    "extension": {
      "id": "#Patient.extension",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
      "xml-order": 70
    },
    "modifierExtension": {
      "id": "#Patient.modifierExtension",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
      "xml-order": 80
    },
    "identifier": {
      "id": "#Patient.identifier",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Identifier",
      "slice": {
        "ordered": false,
        "defaultAtEnd": false,
        "case": [
          {
            "name": "Fixed",
            "condition": {
              "pathSelector": {
                "path": "system",
                "assertion": {
                  "Fixed[uri]": "http://example.com/some-bsn-uri"
                }
              }
            },
            "assertion": {
              "id": "#Patient.identifier:fixed",
              "cardinality": "0..*",
              "children": {
                "id": {
                  "id": "#Patient.identifier.id",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/string",
                  "xml-order": 10
                },
                "extension": {
                  "id": "#Patient.identifier.extension",
                  "cardinality": "0..*",
                  "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
                  "xml-order": 20
                },
                "use": {
                  "id": "#Patient.identifier.use",
                  "binding": {
                    "abstractAllowed": true,
                    "strength": "required",
                    "valueSet": "http://hl7.org/fhir/ValueSet/identifier-use"
                  },
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/code",
                  "xml-order": 30
                },
                "type": {
                  "id": "#Patient.identifier.type",
                  "binding": {
                    "abstractAllowed": true,
                    "strength": "extensible",
                    "valueSet": "http://hl7.org/fhir/ValueSet/identifier-type"
                  },
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
                  "xml-order": 40
                },
                "system": {
                  "id": "#Patient.identifier.system",
                  "Fixed[uri]": "http://example.com/some-bsn-uri",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/uri",
                  "xml-order": 50
                },
                "value": {
                  "id": "#Patient.identifier.value",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/string",
                  "xml-order": 60
                },
                "period": {
                  "id": "#Patient.identifier.period",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/Period",
                  "xml-order": 70
                },
                "assigner": {
                  "id": "#Patient.identifier.assigner",
                  "cardinality": "0..1",
                  "allOf": [
                    {
                      "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
                    },
                    {
                      "validate": {
                        "schema": {
                          "ref": "http://hl7.org/fhir/StructureDefinition/Organization"
                        }
                      }
                    }
                  ],
                  "xml-order": 80
                }
              }
            }
          },
          {
            "name": "PatternBinding",
            "condition": {
              "pathSelector": {
                "path": "system",
                "assertion": {
                  "allOf": {
                    "shortcircuitEvaluation": true,
                    "members": [
                      {
                        "pattern[uri]": "http://example.com/someuri"
                      },
                      {
                        "binding": {
                          "abstractAllowed": true,
                          "strength": "required",
                          "valueSet": "http://example.com/demobinding"
                        }
                      }
                    ]
                  }
                }
              }
            },
            "assertion": {
              "id": "#Patient.identifier:PatternBinding",
              "cardinality": "0..*",
              "children": {
                "id": {
                  "id": "#Patient.identifier.id",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/string",
                  "xml-order": 10
                },
                "extension": {
                  "id": "#Patient.identifier.extension",
                  "cardinality": "0..*",
                  "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
                  "xml-order": 20
                },
                "use": {
                  "id": "#Patient.identifier.use",
                  "binding": {
                    "abstractAllowed": true,
                    "strength": "required",
                    "valueSet": "http://hl7.org/fhir/ValueSet/identifier-use"
                  },
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/code",
                  "xml-order": 30
                },
                "type": {
                  "id": "#Patient.identifier.type",
                  "binding": {
                    "abstractAllowed": true,
                    "strength": "extensible",
                    "valueSet": "http://hl7.org/fhir/ValueSet/identifier-type"
                  },
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
                  "xml-order": 40
                },
                "system": {
                  "id": "#Patient.identifier.system",
                  "pattern[uri]": "http://example.com/someuri",
                  "binding": {
                    "abstractAllowed": true,
                    "strength": "required",
                    "valueSet": "http://example.com/demobinding"
                  },
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/uri",
                  "xml-order": 50
                },
                "value": {
                  "id": "#Patient.identifier.value",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/string",
                  "xml-order": 60
                },
                "period": {
                  "id": "#Patient.identifier.period",
                  "cardinality": "0..1",
                  "ref": "http://hl7.org/fhir/StructureDefinition/Period",
                  "xml-order": 70
                },
                "assigner": {
                  "id": "#Patient.identifier.assigner",
                  "cardinality": "0..1",
                  "allOf": [
                    {
                      "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
                    },
                    {
                      "validate": {
                        "schema": {
                          "ref": "http://hl7.org/fhir/StructureDefinition/Organization"
                        }
                      }
                    }
                  ],
                  "xml-order": 80
                }
              }
            }
          }
        ],
        "default": {
          "issue": {
            "issueNumber": 1026,
            "severity": "Error",
            "message": "Element does not match any slice and the group is closed.",
            "type": "Invalid"
          }
        }
      },
      "xml-order": 90
    },
    "active": {
      "id": "#Patient.active",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/boolean",
      "xml-order": 100
    },
    "name": {
      "id": "#Patient.name",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/HumanName",
      "xml-order": 110
    },
    "telecom": {
      "id": "#Patient.telecom",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/ContactPoint",
      "xml-order": 120
    },
    "gender": {
      "id": "#Patient.gender",
      "binding": {
        "abstractAllowed": true,
        "strength": "required",
        "valueSet": "http://hl7.org/fhir/ValueSet/administrative-gender"
      },
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/code",
      "xml-order": 130
    },
    "birthDate": {
      "id": "#Patient.birthDate",
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/date",
      "xml-order": 140
    },
    "deceased[x]": {
      "id": "#Patient.deceased[x]",
      "cardinality": "0..1",
      "slice": {
        "ordered": false,
        "defaultAtEnd": false,
        "case": [
          {
            "name": "boolean",
            "condition": {
              "fhir-type-label": "boolean"
            },
            "assertion": {
              "ref": "http://hl7.org/fhir/StructureDefinition/boolean"
            }
          },
          {
            "name": "dateTime",
            "condition": {
              "fhir-type-label": "dateTime"
            },
            "assertion": {
              "ref": "http://hl7.org/fhir/StructureDefinition/dateTime"
            }
          }
        ],
        "default": {
          "issue": {
            "issueNumber": 1011,
            "severity": "Error",
            "message": "Element is of type '%INSTANCETYPE%', which is not one of the allowed choice types ('boolean','dateTime')",
            "type": "Invalid"
          }
        }
      },
      "xml-order": 150
    },
    "address": {
      "id": "#Patient.address",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Address",
      "xml-order": 160
    },
    "maritalStatus": {
      "id": "#Patient.maritalStatus",
      "binding": {
        "abstractAllowed": true,
        "strength": "extensible",
        "valueSet": "http://hl7.org/fhir/ValueSet/marital-status"
      },
      "cardinality": "0..1",
      "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
      "xml-order": 170
    },
    "multipleBirth[x]": {
      "id": "#Patient.multipleBirth[x]",
      "cardinality": "0..1",
      "slice": {
        "ordered": false,
        "defaultAtEnd": false,
        "case": [
          {
            "name": "boolean",
            "condition": {
              "fhir-type-label": "boolean"
            },
            "assertion": {
              "ref": "http://hl7.org/fhir/StructureDefinition/boolean"
            }
          },
          {
            "name": "integer",
            "condition": {
              "fhir-type-label": "integer"
            },
            "assertion": {
              "ref": "http://hl7.org/fhir/StructureDefinition/integer"
            }
          }
        ],
        "default": {
          "issue": {
            "issueNumber": 1011,
            "severity": "Error",
            "message": "Element is of type '%INSTANCETYPE%', which is not one of the allowed choice types ('boolean','integer')",
            "type": "Invalid"
          }
        }
      },
      "xml-order": 180
    },
    "photo": {
      "id": "#Patient.photo",
      "cardinality": "0..*",
      "ref": "http://hl7.org/fhir/StructureDefinition/Attachment",
      "xml-order": 190
    },
    "contact": {
      "id": "#Patient.contact",
      "FastInvariant-ele1": {},
      "fhirPath-pat-1": {
        "key": "pat-1",
        "expression": "name.exists() or telecom.exists() or address.exists() or organization.exists()",
        "severity": "error",
        "bestPractice": false,
        "humanDescription": "SHALL at least contain a contact's details or a reference to an organization"
      },
      "cardinality": "0..*",
      "children": {
        "id": {
          "id": "#Patient.contact.id",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/string",
          "xml-order": 10
        },
        "extension": {
          "id": "#Patient.contact.extension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 20
        },
        "modifierExtension": {
          "id": "#Patient.contact.modifierExtension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 30
        },
        "relationship": {
          "id": "#Patient.contact.relationship",
          "binding": {
            "abstractAllowed": true,
            "strength": "extensible",
            "valueSet": "http://hl7.org/fhir/ValueSet/v2-0131"
          },
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
          "xml-order": 40
        },
        "name": {
          "id": "#Patient.contact.name",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/HumanName",
          "xml-order": 50
        },
        "telecom": {
          "id": "#Patient.contact.telecom",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/ContactPoint",
          "xml-order": 60
        },
        "address": {
          "id": "#Patient.contact.address",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/Address",
          "xml-order": 70
        },
        "gender": {
          "id": "#Patient.contact.gender",
          "binding": {
            "abstractAllowed": true,
            "strength": "required",
            "valueSet": "http://hl7.org/fhir/ValueSet/administrative-gender"
          },
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/code",
          "xml-order": 80
        },
        "organization": {
          "id": "#Patient.contact.organization",
          "cardinality": "0..1",
          "allOf": [
            {
              "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
            },
            {
              "validate": {
                "schema": {
                  "ref": "http://hl7.org/fhir/StructureDefinition/Organization"
                }
              }
            }
          ],
          "xml-order": 90
        },
        "period": {
          "id": "#Patient.contact.period",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/Period",
          "xml-order": 100
        }
      },
      "xml-order": 200
    },
    "animal": {
      "id": "#Patient.animal",
      "FastInvariant-ele1": {},
      "cardinality": "0..1",
      "children": {
        "id": {
          "id": "#Patient.animal.id",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/string",
          "xml-order": 10
        },
        "extension": {
          "id": "#Patient.animal.extension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 20
        },
        "modifierExtension": {
          "id": "#Patient.animal.modifierExtension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 30
        },
        "species": {
          "id": "#Patient.animal.species",
          "binding": {
            "abstractAllowed": true,
            "strength": "example",
            "valueSet": "http://hl7.org/fhir/ValueSet/animal-species"
          },
          "cardinality": "1..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
          "xml-order": 40
        },
        "breed": {
          "id": "#Patient.animal.breed",
          "binding": {
            "abstractAllowed": true,
            "strength": "example",
            "valueSet": "http://hl7.org/fhir/ValueSet/animal-breeds"
          },
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
          "xml-order": 50
        },
        "genderStatus": {
          "id": "#Patient.animal.genderStatus",
          "binding": {
            "abstractAllowed": true,
            "strength": "example",
            "valueSet": "http://hl7.org/fhir/ValueSet/animal-genderstatus"
          },
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
          "xml-order": 60
        }
      },
      "xml-order": 210
    },
    "communication": {
      "id": "#Patient.communication",
      "FastInvariant-ele1": {},
      "cardinality": "0..*",
      "children": {
        "id": {
          "id": "#Patient.communication.id",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/string",
          "xml-order": 10
        },
        "extension": {
          "id": "#Patient.communication.extension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 20
        },
        "modifierExtension": {
          "id": "#Patient.communication.modifierExtension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 30
        },
        "language": {
          "id": "#Patient.communication.language",
          "binding": {
            "abstractAllowed": true,
            "strength": "extensible",
            "valueSet": "http://hl7.org/fhir/ValueSet/languages"
          },
          "cardinality": "1..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
          "xml-order": 40
        },
        "preferred": {
          "id": "#Patient.communication.preferred",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/boolean",
          "xml-order": 50
        }
      },
      "xml-order": 220
    },
    "generalPractitioner": {
      "id": "#Patient.generalPractitioner",
      "cardinality": "0..*",
      "allOf": [
        {
          "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
        },
        {
          "validate": {
            "schema": {
              "slice": {
                "ordered": false,
                "defaultAtEnd": false,
                "case": [
                  {
                    "name": "forOrganization",
                    "condition": {
                      "fhir-type-label": "Organization"
                    },
                    "assertion": {
                      "ref": "http://hl7.org/fhir/StructureDefinition/Organization"
                    }
                  },
                  {
                    "name": "forPractitioner",
                    "condition": {
                      "fhir-type-label": "Practitioner"
                    },
                    "assertion": {
                      "ref": "http://hl7.org/fhir/StructureDefinition/Practitioner"
                    }
                  }
                ],
                "default": {
                  "issue": {
                    "issueNumber": 1011,
                    "severity": "Error",
                    "message": "Referenced resource '%RESOURCEURL%' does not validate against any of the expected target profiles (http://hl7.org/fhir/StructureDefinition/Organization, http://hl7.org/fhir/StructureDefinition/Practitioner). None of these are profiles on type %INSTANCETYPE% of the resource.",
                    "type": "Invalid"
                  }
                }
              }
            }
          }
        }
      ],
      "xml-order": 230
    },
    "managingOrganization": {
      "id": "#Patient.managingOrganization",
      "cardinality": "0..1",
      "allOf": [
        {
          "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
        },
        {
          "validate": {
            "schema": {
              "ref": "http://hl7.org/fhir/StructureDefinition/Organization"
            }
          }
        }
      ],
      "xml-order": 240
    },
    "link": {
      "id": "#Patient.link",
      "FastInvariant-ele1": {},
      "cardinality": "0..*",
      "children": {
        "id": {
          "id": "#Patient.link.id",
          "cardinality": "0..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/string",
          "xml-order": 10
        },
        "extension": {
          "id": "#Patient.link.extension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 20
        },
        "modifierExtension": {
          "id": "#Patient.link.modifierExtension",
          "cardinality": "0..*",
          "ref": "http://hl7.org/fhir/StructureDefinition/Extension",
          "xml-order": 30
        },
        "other": {
          "id": "#Patient.link.other",
          "cardinality": "1..1",
          "allOf": [
            {
              "ref": "http://hl7.org/fhir/StructureDefinition/Reference"
            },
            {
              "validate": {
                "schema": {
                  "slice": {
                    "ordered": false,
                    "defaultAtEnd": false,
                    "case": [
                      {
                        "name": "forPatient",
                        "condition": {
                          "fhir-type-label": "Patient"
                        },
                        "assertion": {
                          "ref": "http://hl7.org/fhir/StructureDefinition/Patient"
                        }
                      },
                      {
                        "name": "forRelatedPerson",
                        "condition": {
                          "fhir-type-label": "RelatedPerson"
                        },
                        "assertion": {
                          "ref": "http://hl7.org/fhir/StructureDefinition/RelatedPerson"
                        }
                      }
                    ],
                    "default": {
                      "issue": {
                        "issueNumber": 1011,
                        "severity": "Error",
                        "message": "Referenced resource '%RESOURCEURL%' does not validate against any of the expected target profiles (http://hl7.org/fhir/StructureDefinition/Patient, http://hl7.org/fhir/StructureDefinition/RelatedPerson). None of these are profiles on type %INSTANCETYPE% of the resource.",
                        "type": "Invalid"
                      }
                    }
                  }
                }
              }
            }
          ],
          "xml-order": 40
        },
        "type": {
          "id": "#Patient.link.type",
          "binding": {
            "abstractAllowed": true,
            "strength": "required",
            "valueSet": "http://hl7.org/fhir/ValueSet/link-type"
          },
          "cardinality": "1..1",
          "ref": "http://hl7.org/fhir/StructureDefinition/code",
          "xml-order": 50
        }
      },
      "xml-order": 250
    }
  }
}